"use strict";(()=>{var e={};e.id=174,e.ids=[174],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},8405:(e,t,r)=>{r.r(t),r.d(t,{config:()=>d,default:()=>l,routeModule:()=>c});var a={};r.r(a),r.d(a,{default:()=>handler});var o=r(1802),i=r(7153),n=r(6249),s=r(7226);async function handler(e,t){if("GET"!==e.method)return t.setHeader("Allow",["GET"]),t.status(405).json({error:"Method not allowed"});try{let e=await s.Z,r=e.db("eventhorizon"),a=await r.collection("events").find({}).sort({date:1}).toArray(),o=a.map(e=>({_id:e._id.toString(),title:e.title,artist:e.artist,image:e.image,date:new Date(e.date).toISOString(),time:e.time,venue:e.venue,location:e.location,category:e.category,price:Number(e.price),originalPrice:e.originalPrice?Number(e.originalPrice):void 0,rating:Number(e.rating),seatsLeft:Number(e.seatsLeft)}));return console.log("Fetched event images:",o.map(e=>e.image)),t.status(200).json({events:o})}catch(e){return console.error("Database error:",e),t.status(500).json({error:"Failed to fetch events",...e instanceof Error&&{message:e.message}})}}let l=(0,n.l)(a,"default"),d=(0,n.l)(a,"config"),c=new o.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/events",pathname:"/api/events",bundlePath:"",filename:""},userland:a})},7226:(e,t,r)=>{let a;r.d(t,{Z:()=>n});let o=require("mongodb"),i=process.env.MONGODB_URI;if(!process.env.MONGODB_URI)throw Error("Please add your Mongo URI to .env.local");{let e=new o.MongoClient(i,{});a=e.connect()}let n=a}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[702],()=>__webpack_exec__(8405));module.exports=r})();